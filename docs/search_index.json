{"index":{"version":"0.5.12","fields":[{"name":"title","boost":10},{"name":"keywords","boost":15},{"name":"body","boost":1}],"ref":"url","documentStore":{"store":{"./":["一些学习笔记与技术总结","简介"],"redis_core/":["redis核心技术"],"redis_core/persistence/":["持久化机制","通过aof日志和rdb快照的方式，使redis是可靠的。"],"redis_core/persistence/aof.html":["alway","aof","aof日志","aof日志的内容","aof是以追加的方式，逐一记录收到的命令，当一个键值对被多条写命令反复修改时，aof文件会记录相应的多条命令，导致文件越来越大。","aof虽然避免了对当前命令的阻塞，但可能会阻塞下个命令。因为aof日志（落盘）也是在主线程执行的","aof重写会阻塞主线程吗？","aof重写机制就是，redis根据数据库现状创建一个新的aof文件，读取库中所有键值对，对每一个键值对用一条命令记录它的写入。起到了”多变一“的效果。","aof重写的潜在风险","everysec","fork子进程的瞬间，会阻塞主进程；fork时不会一次性copy所有内存数据给子进程，而是使用os提供的写时复制（copi","log的wal（写前日志）不同，aof机制是先执行命令，将数据写入内存，再记录日志。","write）机制，避免一次性copy大量数据而阻塞。","”一个拷贝，两处日志“","一个拷贝是指：重写时主线程fork出后台的bgrewriteaof子进程，此时，fork会把主线程的内存拷贝一份给bgrewriteaof，其中包含了数据库中的最新数据，就能进行aof重写了","不会，因为重写过程是后台线程bgrewriteaof完成的。","与mysql的redo","两处日志是指：","主要风险有2点：","优点","保证aof日志中的命令是正确的（命令报错直接返回，避免记录错误的命令）","值有多少字节。当redis重启需要恢复数据时，就会读取aof文件中的命令，逐一执行。","内容示例：*3$3set$7testkey$9testvalu","写后日志","写后日志的风险均来自于aof写入磁盘的时机，redis提供了如下3种写回策略，可通过appendfsync配置项设置：","写回时机","写时拷贝发生时，拷贝bigkey可能会阻塞。","可靠性高，数据基本不丢失","同步写回","命令执行后才记录日志，不会阻塞当前操作","如下所示，*3表示当前命令有3个部分，每部分由“$+数字”开头，后面紧跟命令，这里“数字“表示该部分中命令","宕机时丢失1秒数据","宕机时丢失数据较多","当redis刚执行完一个命令，还来不及记录日志就宕机了，那该命令和相应的数据有丢失风险","性能好","性能适中","操作系统控制写回","新的aof重写日志，新的写操作也会被写到重写日志缓冲区中，重写完成后，将重写缓冲区的最新操作写入新的aof文件，此时，新的aof文件就可以将旧的aof文件替换掉了","日志文件太大了怎么办？——aof重写机制","正在使用的aof日志，redis会将新的写操作日志写入其缓冲区，防止重写期间宕机丢日志","此方式有几个优点：","每个写命令都要落盘，性能影响较大","每秒写回","潜在风险：","缺点","配置项","重写可以概括为","键"],"redis_core/persistence/rdb.html":["aof与rdb混合使用","aof和rdb如何选择","bgsave（默认配置）：创建子进程，专门用于写入rdb，避免了主线程的阻塞。","fork子进程的过程本身会阻塞主线程。频繁的fork，就会频繁的阻塞。","rdb","rdb快照","rdb快照按一定频率进行，在两次快照之间，使用aof日志记录这期间所有命令，第二次做全量快照时，就可以清空aof日志。aof文件不会过大了，也可以避免重写。","redis提供了如下两个命令来生成rdb文件:","save：在主线程中执行，会导致阻塞","但是得记住哪些数据被修改了，需要额外的元信息，空间开销过大，可能得不偿失。","允许分钟级别的数据丢失时，可以只用rdb。","在生成rdb的过程中，redis也能接收数据修改操作，同样是写时复制机制。一开始bgsave子进程会共享主线程数据，当主线程要修改某块数据，就会先复制该块数据给bgsave子进程，bgsave会将该块数据副本写入rdb文件。","如果使用增量快照：做了一次全量快照后，后续的快照只对修改的数据进行快照记录，减少开销。","宕机后的快速恢复","当redis宕机时，可以采用aof进行恢复，但是如果aof中操作日志太多，redis就会回复的慢，影响正常使用。因此引入rdb快照（全量快照），将redis某一时刻的状态以文件的形式写到磁盘上。","数据不能丢失时，选用aof+rdb混和使用。","生成rdb快照的频率？","生成rdb过程会阻塞主线程吗","磁盘压力大，多个快照抢占磁盘资源带宽，前一个快照还没完成，后一个又开始做了，形成恶性循环。","若只用aof，优先使用everysec配置项，因为他在可靠性和性能之间取了一个平衡。","频繁的进行全量快照，有两方面的开销:"],"redis_core/master-slave/":["主从集群"],"redis_core/master-slave/data_sync.html":["主从数据同步"]},"length":7},"tokenStore":{"root":{"docs":{},"一":{"docs":{},"些":{"docs":{},"学":{"docs":{},"习":{"docs":{},"笔":{"docs":{},"记":{"docs":{},"与":{"docs":{},"技":{"docs":{},"术":{"docs":{},"总":{"docs":{},"结":{"docs":{"./":{"ref":"./","tf":0.5}}}}}}}}}}}},"个":{"docs":{},"拷":{"docs":{},"贝":{"docs":{},"是":{"docs":{},"指":{"docs":{},"：":{"docs":{},"重":{"docs":{},"写":{"docs":{},"时":{"docs":{},"主":{"docs":{},"线":{"docs":{},"程":{"docs":{},"f":{"docs":{},"o":{"docs":{},"r":{"docs":{},"k":{"docs":{},"出":{"docs":{},"后":{"docs":{},"台":{"docs":{},"的":{"docs":{},"b":{"docs":{},"g":{"docs":{},"r":{"docs":{},"e":{"docs":{},"w":{"docs":{},"r":{"docs":{},"i":{"docs":{},"t":{"docs":{},"e":{"docs":{},"a":{"docs":{},"o":{"docs":{},"f":{"docs":{},"子":{"docs":{},"进":{"docs":{},"程":{"docs":{},"，":{"docs":{},"此":{"docs":{},"时":{"docs":{},"，":{"docs":{},"f":{"docs":{},"o":{"docs":{},"r":{"docs":{},"k":{"docs":{},"会":{"docs":{},"把":{"docs":{},"主":{"docs":{},"线":{"docs":{},"程":{"docs":{},"的":{"docs":{},"内":{"docs":{},"存":{"docs":{},"拷":{"docs":{},"贝":{"docs":{},"一":{"docs":{},"份":{"docs":{},"给":{"docs":{},"b":{"docs":{},"g":{"docs":{},"r":{"docs":{},"e":{"docs":{},"w":{"docs":{},"r":{"docs":{},"i":{"docs":{},"t":{"docs":{},"e":{"docs":{},"a":{"docs":{},"o":{"docs":{},"f":{"docs":{},"，":{"docs":{},"其":{"docs":{},"中":{"docs":{},"包":{"docs":{},"含":{"docs":{},"了":{"docs":{},"数":{"docs":{},"据":{"docs":{},"库":{"docs":{},"中":{"docs":{},"的":{"docs":{},"最":{"docs":{},"新":{"docs":{},"数":{"docs":{},"据":{"docs":{},"，":{"docs":{},"就":{"docs":{},"能":{"docs":{},"进":{"docs":{},"行":{"docs":{},"a":{"docs":{},"o":{"docs":{},"f":{"docs":{},"重":{"docs":{},"写":{"docs":{},"了":{"docs":{"redis_core/persistence/aof.html":{"ref":"redis_core/persistence/aof.html","tf":0.02127659574468085}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}},"简":{"docs":{},"介":{"docs":{"./":{"ref":"./","tf":10.5}}}},"r":{"docs":{},"e":{"docs":{},"d":{"docs":{},"i":{"docs":{},"s":{"docs":{},"核":{"docs":{},"心":{"docs":{},"技":{"docs":{},"术":{"docs":{"redis_core/":{"ref":"redis_core/","tf":11}}}}}},"提":{"docs":{},"供":{"docs":{},"了":{"docs":{},"如":{"docs":{},"下":{"docs":{},"两":{"docs":{},"个":{"docs":{},"命":{"docs":{},"令":{"docs":{},"来":{"docs":{},"生":{"docs":{},"成":{"docs":{},"r":{"docs":{},"d":{"docs":{},"b":{"docs":{},"文":{"docs":{},"件":{"docs":{},":":{"docs":{"redis_core/persistence/rdb.html":{"ref":"redis_core/persistence/rdb.html","tf":0.05}}}}}}}}}}}}}}}}}}}}}}}},"d":{"docs":{},"b":{"docs":{"redis_core/persistence/rdb.html":{"ref":"redis_core/persistence/rdb.html","tf":10}},"快":{"docs":{},"照":{"docs":{"redis_core/persistence/rdb.html":{"ref":"redis_core/persistence/rdb.html","tf":0.05}},"按":{"docs":{},"一":{"docs":{},"定":{"docs":{},"频":{"docs":{},"率":{"docs":{},"进":{"docs":{},"行":{"docs":{},"，":{"docs":{},"在":{"docs":{},"两":{"docs":{},"次":{"docs":{},"快":{"docs":{},"照":{"docs":{},"之":{"docs":{},"间":{"docs":{},"，":{"docs":{},"使":{"docs":{},"用":{"docs":{},"a":{"docs":{},"o":{"docs":{},"f":{"docs":{},"日":{"docs":{},"志":{"docs":{},"记":{"docs":{},"录":{"docs":{},"这":{"docs":{},"期":{"docs":{},"间":{"docs":{},"所":{"docs":{},"有":{"docs":{},"命":{"docs":{},"令":{"docs":{},"，":{"docs":{},"第":{"docs":{},"二":{"docs":{},"次":{"docs":{},"做":{"docs":{},"全":{"docs":{},"量":{"docs":{},"快":{"docs":{},"照":{"docs":{},"时":{"docs":{},"，":{"docs":{},"就":{"docs":{},"可":{"docs":{},"以":{"docs":{},"清":{"docs":{},"空":{"docs":{},"a":{"docs":{},"o":{"docs":{},"f":{"docs":{},"日":{"docs":{},"志":{"docs":{},"。":{"docs":{},"a":{"docs":{},"o":{"docs":{},"f":{"docs":{},"文":{"docs":{},"件":{"docs":{},"不":{"docs":{},"会":{"docs":{},"过":{"docs":{},"大":{"docs":{},"了":{"docs":{},"，":{"docs":{},"也":{"docs":{},"可":{"docs":{},"以":{"docs":{},"避":{"docs":{},"免":{"docs":{},"重":{"docs":{},"写":{"docs":{},"。":{"docs":{"redis_core/persistence/rdb.html":{"ref":"redis_core/persistence/rdb.html","tf":0.05}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}},"持":{"docs":{},"久":{"docs":{},"化":{"docs":{},"机":{"docs":{},"制":{"docs":{"redis_core/persistence/":{"ref":"redis_core/persistence/","tf":10.5}}}}}}},"通":{"docs":{},"过":{"docs":{},"a":{"docs":{},"o":{"docs":{},"f":{"docs":{},"日":{"docs":{},"志":{"docs":{},"和":{"docs":{},"r":{"docs":{},"d":{"docs":{},"b":{"docs":{},"快":{"docs":{},"照":{"docs":{},"的":{"docs":{},"方":{"docs":{},"式":{"docs":{},"，":{"docs":{},"使":{"docs":{},"r":{"docs":{},"e":{"docs":{},"d":{"docs":{},"i":{"docs":{},"s":{"docs":{},"是":{"docs":{},"可":{"docs":{},"靠":{"docs":{},"的":{"docs":{},"。":{"docs":{"redis_core/persistence/":{"ref":"redis_core/persistence/","tf":0.5}}}}}}}}}}}}}}}}}}}}}}}}}}}}}},"a":{"docs":{},"l":{"docs":{},"w":{"docs":{},"a":{"docs":{},"y":{"docs":{"redis_core/persistence/aof.html":{"ref":"redis_core/persistence/aof.html","tf":0.02127659574468085}}}}}},"o":{"docs":{},"f":{"docs":{"redis_core/persistence/aof.html":{"ref":"redis_core/persistence/aof.html","tf":10}},"日":{"docs":{},"志":{"docs":{"redis_core/persistence/aof.html":{"ref":"redis_core/persistence/aof.html","tf":0.02127659574468085}},"的":{"docs":{},"内":{"docs":{},"容":{"docs":{"redis_core/persistence/aof.html":{"ref":"redis_core/persistence/aof.html","tf":0.02127659574468085}}}}}}},"是":{"docs":{},"以":{"docs":{},"追":{"docs":{},"加":{"docs":{},"的":{"docs":{},"方":{"docs":{},"式":{"docs":{},"，":{"docs":{},"逐":{"docs":{},"一":{"docs":{},"记":{"docs":{},"录":{"docs":{},"收":{"docs":{},"到":{"docs":{},"的":{"docs":{},"命":{"docs":{},"令":{"docs":{},"，":{"docs":{},"当":{"docs":{},"一":{"docs":{},"个":{"docs":{},"键":{"docs":{},"值":{"docs":{},"对":{"docs":{},"被":{"docs":{},"多":{"docs":{},"条":{"docs":{},"写":{"docs":{},"命":{"docs":{},"令":{"docs":{},"反":{"docs":{},"复":{"docs":{},"修":{"docs":{},"改":{"docs":{},"时":{"docs":{},"，":{"docs":{},"a":{"docs":{},"o":{"docs":{},"f":{"docs":{},"文":{"docs":{},"件":{"docs":{},"会":{"docs":{},"记":{"docs":{},"录":{"docs":{},"相":{"docs":{},"应":{"docs":{},"的":{"docs":{},"多":{"docs":{},"条":{"docs":{},"命":{"docs":{},"令":{"docs":{},"，":{"docs":{},"导":{"docs":{},"致":{"docs":{},"文":{"docs":{},"件":{"docs":{},"越":{"docs":{},"来":{"docs":{},"越":{"docs":{},"大":{"docs":{},"。":{"docs":{"redis_core/persistence/aof.html":{"ref":"redis_core/persistence/aof.html","tf":0.02127659574468085}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}},"虽":{"docs":{},"然":{"docs":{},"避":{"docs":{},"免":{"docs":{},"了":{"docs":{},"对":{"docs":{},"当":{"docs":{},"前":{"docs":{},"命":{"docs":{},"令":{"docs":{},"的":{"docs":{},"阻":{"docs":{},"塞":{"docs":{},"，":{"docs":{},"但":{"docs":{},"可":{"docs":{},"能":{"docs":{},"会":{"docs":{},"阻":{"docs":{},"塞":{"docs":{},"下":{"docs":{},"个":{"docs":{},"命":{"docs":{},"令":{"docs":{},"。":{"docs":{},"因":{"docs":{},"为":{"docs":{},"a":{"docs":{},"o":{"docs":{},"f":{"docs":{},"日":{"docs":{},"志":{"docs":{},"（":{"docs":{},"落":{"docs":{},"盘":{"docs":{},"）":{"docs":{},"也":{"docs":{},"是":{"docs":{},"在":{"docs":{},"主":{"docs":{},"线":{"docs":{},"程":{"docs":{},"执":{"docs":{},"行":{"docs":{},"的":{"docs":{"redis_core/persistence/aof.html":{"ref":"redis_core/persistence/aof.html","tf":0.02127659574468085}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}},"重":{"docs":{},"写":{"docs":{},"会":{"docs":{},"阻":{"docs":{},"塞":{"docs":{},"主":{"docs":{},"线":{"docs":{},"程":{"docs":{},"吗":{"docs":{},"？":{"docs":{"redis_core/persistence/aof.html":{"ref":"redis_core/persistence/aof.html","tf":0.02127659574468085}}}}}}}}}},"机":{"docs":{},"制":{"docs":{},"就":{"docs":{},"是":{"docs":{},"，":{"docs":{},"r":{"docs":{},"e":{"docs":{},"d":{"docs":{},"i":{"docs":{},"s":{"docs":{},"根":{"docs":{},"据":{"docs":{},"数":{"docs":{},"据":{"docs":{},"库":{"docs":{},"现":{"docs":{},"状":{"docs":{},"创":{"docs":{},"建":{"docs":{},"一":{"docs":{},"个":{"docs":{},"新":{"docs":{},"的":{"docs":{},"a":{"docs":{},"o":{"docs":{},"f":{"docs":{},"文":{"docs":{},"件":{"docs":{},"，":{"docs":{},"读":{"docs":{},"取":{"docs":{},"库":{"docs":{},"中":{"docs":{},"所":{"docs":{},"有":{"docs":{},"键":{"docs":{},"值":{"docs":{},"对":{"docs":{},"，":{"docs":{},"对":{"docs":{},"每":{"docs":{},"一":{"docs":{},"个":{"docs":{},"键":{"docs":{},"值":{"docs":{},"对":{"docs":{},"用":{"docs":{},"一":{"docs":{},"条":{"docs":{},"命":{"docs":{},"令":{"docs":{},"记":{"docs":{},"录":{"docs":{},"它":{"docs":{},"的":{"docs":{},"写":{"docs":{},"入":{"docs":{},"。":{"docs":{},"起":{"docs":{},"到":{"docs":{},"了":{"docs":{},"”":{"docs":{},"多":{"docs":{},"变":{"docs":{},"一":{"docs":{},"“":{"docs":{},"的":{"docs":{},"效":{"docs":{},"果":{"docs":{},"。":{"docs":{"redis_core/persistence/aof.html":{"ref":"redis_core/persistence/aof.html","tf":0.02127659574468085}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}},"的":{"docs":{},"潜":{"docs":{},"在":{"docs":{},"风":{"docs":{},"险":{"docs":{"redis_core/persistence/aof.html":{"ref":"redis_core/persistence/aof.html","tf":0.02127659574468085}}}}}}}}},"与":{"docs":{},"r":{"docs":{},"d":{"docs":{},"b":{"docs":{},"混":{"docs":{},"合":{"docs":{},"使":{"docs":{},"用":{"docs":{"redis_core/persistence/rdb.html":{"ref":"redis_core/persistence/rdb.html","tf":0.05}}}}}}}}}},"和":{"docs":{},"r":{"docs":{},"d":{"docs":{},"b":{"docs":{},"如":{"docs":{},"何":{"docs":{},"选":{"docs":{},"择":{"docs":{"redis_core/persistence/rdb.html":{"ref":"redis_core/persistence/rdb.html","tf":0.05}}}}}}}}}}}}},"e":{"docs":{},"v":{"docs":{},"e":{"docs":{},"r":{"docs":{},"y":{"docs":{},"s":{"docs":{},"e":{"docs":{},"c":{"docs":{"redis_core/persistence/aof.html":{"ref":"redis_core/persistence/aof.html","tf":0.02127659574468085}}}}}}}}}},"f":{"docs":{},"o":{"docs":{},"r":{"docs":{},"k":{"docs":{},"子":{"docs":{},"进":{"docs":{},"程":{"docs":{},"的":{"docs":{},"瞬":{"docs":{},"间":{"docs":{},"，":{"docs":{},"会":{"docs":{},"阻":{"docs":{},"塞":{"docs":{},"主":{"docs":{},"进":{"docs":{},"程":{"docs":{},"；":{"docs":{},"f":{"docs":{},"o":{"docs":{},"r":{"docs":{},"k":{"docs":{},"时":{"docs":{},"不":{"docs":{},"会":{"docs":{},"一":{"docs":{},"次":{"docs":{},"性":{"docs":{},"c":{"docs":{},"o":{"docs":{},"p":{"docs":{},"y":{"docs":{},"所":{"docs":{},"有":{"docs":{},"内":{"docs":{},"存":{"docs":{},"数":{"docs":{},"据":{"docs":{},"给":{"docs":{},"子":{"docs":{},"进":{"docs":{},"程":{"docs":{},"，":{"docs":{},"而":{"docs":{},"是":{"docs":{},"使":{"docs":{},"用":{"docs":{},"o":{"docs":{},"s":{"docs":{},"提":{"docs":{},"供":{"docs":{},"的":{"docs":{},"写":{"docs":{},"时":{"docs":{},"复":{"docs":{},"制":{"docs":{},"（":{"docs":{},"c":{"docs":{},"o":{"docs":{},"p":{"docs":{},"i":{"docs":{"redis_core/persistence/aof.html":{"ref":"redis_core/persistence/aof.html","tf":0.02127659574468085}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}},"过":{"docs":{},"程":{"docs":{},"本":{"docs":{},"身":{"docs":{},"会":{"docs":{},"阻":{"docs":{},"塞":{"docs":{},"主":{"docs":{},"线":{"docs":{},"程":{"docs":{},"。":{"docs":{},"频":{"docs":{},"繁":{"docs":{},"的":{"docs":{},"f":{"docs":{},"o":{"docs":{},"r":{"docs":{},"k":{"docs":{},"，":{"docs":{},"就":{"docs":{},"会":{"docs":{},"频":{"docs":{},"繁":{"docs":{},"的":{"docs":{},"阻":{"docs":{},"塞":{"docs":{},"。":{"docs":{"redis_core/persistence/rdb.html":{"ref":"redis_core/persistence/rdb.html","tf":0.05}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}},"l":{"docs":{},"o":{"docs":{},"g":{"docs":{},"的":{"docs":{},"w":{"docs":{},"a":{"docs":{},"l":{"docs":{},"（":{"docs":{},"写":{"docs":{},"前":{"docs":{},"日":{"docs":{},"志":{"docs":{},"）":{"docs":{},"不":{"docs":{},"同":{"docs":{},"，":{"docs":{},"a":{"docs":{},"o":{"docs":{},"f":{"docs":{},"机":{"docs":{},"制":{"docs":{},"是":{"docs":{},"先":{"docs":{},"执":{"docs":{},"行":{"docs":{},"命":{"docs":{},"令":{"docs":{},"，":{"docs":{},"将":{"docs":{},"数":{"docs":{},"据":{"docs":{},"写":{"docs":{},"入":{"docs":{},"内":{"docs":{},"存":{"docs":{},"，":{"docs":{},"再":{"docs":{},"记":{"docs":{},"录":{"docs":{},"日":{"docs":{},"志":{"docs":{},"。":{"docs":{"redis_core/persistence/aof.html":{"ref":"redis_core/persistence/aof.html","tf":0.02127659574468085}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}},"w":{"docs":{},"r":{"docs":{},"i":{"docs":{},"t":{"docs":{},"e":{"docs":{},"）":{"docs":{},"机":{"docs":{},"制":{"docs":{},"，":{"docs":{},"避":{"docs":{},"免":{"docs":{},"一":{"docs":{},"次":{"docs":{},"性":{"docs":{},"c":{"docs":{},"o":{"docs":{},"p":{"docs":{},"y":{"docs":{},"大":{"docs":{},"量":{"docs":{},"数":{"docs":{},"据":{"docs":{},"而":{"docs":{},"阻":{"docs":{},"塞":{"docs":{},"。":{"docs":{"redis_core/persistence/aof.html":{"ref":"redis_core/persistence/aof.html","tf":0.02127659574468085}}}}}}}}}}}}}}}}}}}}}}}}}}}},"”":{"docs":{},"一":{"docs":{},"个":{"docs":{},"拷":{"docs":{},"贝":{"docs":{},"，":{"docs":{},"两":{"docs":{},"处":{"docs":{},"日":{"docs":{},"志":{"docs":{},"“":{"docs":{"redis_core/persistence/aof.html":{"ref":"redis_core/persistence/aof.html","tf":0.02127659574468085}}}}}}}}}}}}},"不":{"docs":{},"会":{"docs":{},"，":{"docs":{},"因":{"docs":{},"为":{"docs":{},"重":{"docs":{},"写":{"docs":{},"过":{"docs":{},"程":{"docs":{},"是":{"docs":{},"后":{"docs":{},"台":{"docs":{},"线":{"docs":{},"程":{"docs":{},"b":{"docs":{},"g":{"docs":{},"r":{"docs":{},"e":{"docs":{},"w":{"docs":{},"r":{"docs":{},"i":{"docs":{},"t":{"docs":{},"e":{"docs":{},"a":{"docs":{},"o":{"docs":{},"f":{"docs":{},"完":{"docs":{},"成":{"docs":{},"的":{"docs":{},"。":{"docs":{"redis_core/persistence/aof.html":{"ref":"redis_core/persistence/aof.html","tf":0.02127659574468085}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}},"与":{"docs":{},"m":{"docs":{},"y":{"docs":{},"s":{"docs":{},"q":{"docs":{},"l":{"docs":{},"的":{"docs":{},"r":{"docs":{},"e":{"docs":{},"d":{"docs":{},"o":{"docs":{"redis_core/persistence/aof.html":{"ref":"redis_core/persistence/aof.html","tf":0.02127659574468085}}}}}}}}}}}}},"两":{"docs":{},"处":{"docs":{},"日":{"docs":{},"志":{"docs":{},"是":{"docs":{},"指":{"docs":{},"：":{"docs":{"redis_core/persistence/aof.html":{"ref":"redis_core/persistence/aof.html","tf":0.02127659574468085}}}}}}}}},"主":{"docs":{},"要":{"docs":{},"风":{"docs":{},"险":{"docs":{},"有":{"2":{"docs":{},"点":{"docs":{},"：":{"docs":{"redis_core/persistence/aof.html":{"ref":"redis_core/persistence/aof.html","tf":0.02127659574468085}}}}},"docs":{}}}}},"从":{"docs":{},"集":{"docs":{},"群":{"docs":{"redis_core/master-slave/":{"ref":"redis_core/master-slave/","tf":11}}}},"数":{"docs":{},"据":{"docs":{},"同":{"docs":{},"步":{"docs":{"redis_core/master-slave/data_sync.html":{"ref":"redis_core/master-slave/data_sync.html","tf":11}}}}}}}},"优":{"docs":{},"点":{"docs":{"redis_core/persistence/aof.html":{"ref":"redis_core/persistence/aof.html","tf":0.02127659574468085}}}},"保":{"docs":{},"证":{"docs":{},"a":{"docs":{},"o":{"docs":{},"f":{"docs":{},"日":{"docs":{},"志":{"docs":{},"中":{"docs":{},"的":{"docs":{},"命":{"docs":{},"令":{"docs":{},"是":{"docs":{},"正":{"docs":{},"确":{"docs":{},"的":{"docs":{},"（":{"docs":{},"命":{"docs":{},"令":{"docs":{},"报":{"docs":{},"错":{"docs":{},"直":{"docs":{},"接":{"docs":{},"返":{"docs":{},"回":{"docs":{},"，":{"docs":{},"避":{"docs":{},"免":{"docs":{},"记":{"docs":{},"录":{"docs":{},"错":{"docs":{},"误":{"docs":{},"的":{"docs":{},"命":{"docs":{},"令":{"docs":{},"）":{"docs":{"redis_core/persistence/aof.html":{"ref":"redis_core/persistence/aof.html","tf":0.02127659574468085}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}},"值":{"docs":{},"有":{"docs":{},"多":{"docs":{},"少":{"docs":{},"字":{"docs":{},"节":{"docs":{},"。":{"docs":{},"当":{"docs":{},"r":{"docs":{},"e":{"docs":{},"d":{"docs":{},"i":{"docs":{},"s":{"docs":{},"重":{"docs":{},"启":{"docs":{},"需":{"docs":{},"要":{"docs":{},"恢":{"docs":{},"复":{"docs":{},"数":{"docs":{},"据":{"docs":{},"时":{"docs":{},"，":{"docs":{},"就":{"docs":{},"会":{"docs":{},"读":{"docs":{},"取":{"docs":{},"a":{"docs":{},"o":{"docs":{},"f":{"docs":{},"文":{"docs":{},"件":{"docs":{},"中":{"docs":{},"的":{"docs":{},"命":{"docs":{},"令":{"docs":{},"，":{"docs":{},"逐":{"docs":{},"一":{"docs":{},"执":{"docs":{},"行":{"docs":{},"。":{"docs":{"redis_core/persistence/aof.html":{"ref":"redis_core/persistence/aof.html","tf":0.02127659574468085}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}},"内":{"docs":{},"容":{"docs":{},"示":{"docs":{},"例":{"docs":{},"：":{"docs":{},"*":{"3":{"docs":{},"$":{"3":{"docs":{},"s":{"docs":{},"e":{"docs":{},"t":{"docs":{},"$":{"7":{"docs":{},"t":{"docs":{},"e":{"docs":{},"s":{"docs":{},"t":{"docs":{},"k":{"docs":{},"e":{"docs":{},"y":{"docs":{},"$":{"9":{"docs":{},"t":{"docs":{},"e":{"docs":{},"s":{"docs":{},"t":{"docs":{},"v":{"docs":{},"a":{"docs":{},"l":{"docs":{},"u":{"docs":{"redis_core/persistence/aof.html":{"ref":"redis_core/persistence/aof.html","tf":0.02127659574468085}}}}}}}}}}},"docs":{}}}}}}}}}},"docs":{}}}}}},"docs":{}}},"docs":{}}}}}}},"写":{"docs":{},"后":{"docs":{},"日":{"docs":{},"志":{"docs":{"redis_core/persistence/aof.html":{"ref":"redis_core/persistence/aof.html","tf":0.02127659574468085}},"的":{"docs":{},"风":{"docs":{},"险":{"docs":{},"均":{"docs":{},"来":{"docs":{},"自":{"docs":{},"于":{"docs":{},"a":{"docs":{},"o":{"docs":{},"f":{"docs":{},"写":{"docs":{},"入":{"docs":{},"磁":{"docs":{},"盘":{"docs":{},"的":{"docs":{},"时":{"docs":{},"机":{"docs":{},"，":{"docs":{},"r":{"docs":{},"e":{"docs":{},"d":{"docs":{},"i":{"docs":{},"s":{"docs":{},"提":{"docs":{},"供":{"docs":{},"了":{"docs":{},"如":{"docs":{},"下":{"3":{"docs":{},"种":{"docs":{},"写":{"docs":{},"回":{"docs":{},"策":{"docs":{},"略":{"docs":{},"，":{"docs":{},"可":{"docs":{},"通":{"docs":{},"过":{"docs":{},"a":{"docs":{},"p":{"docs":{},"p":{"docs":{},"e":{"docs":{},"n":{"docs":{},"d":{"docs":{},"f":{"docs":{},"s":{"docs":{},"y":{"docs":{},"n":{"docs":{},"c":{"docs":{},"配":{"docs":{},"置":{"docs":{},"项":{"docs":{},"设":{"docs":{},"置":{"docs":{},"：":{"docs":{"redis_core/persistence/aof.html":{"ref":"redis_core/persistence/aof.html","tf":0.02127659574468085}}}}}}}}}}}}}}}}}}}}}}}}}}}}},"docs":{}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}},"回":{"docs":{},"时":{"docs":{},"机":{"docs":{"redis_core/persistence/aof.html":{"ref":"redis_core/persistence/aof.html","tf":0.02127659574468085}}}}},"时":{"docs":{},"拷":{"docs":{},"贝":{"docs":{},"发":{"docs":{},"生":{"docs":{},"时":{"docs":{},"，":{"docs":{},"拷":{"docs":{},"贝":{"docs":{},"b":{"docs":{},"i":{"docs":{},"g":{"docs":{},"k":{"docs":{},"e":{"docs":{},"y":{"docs":{},"可":{"docs":{},"能":{"docs":{},"会":{"docs":{},"阻":{"docs":{},"塞":{"docs":{},"。":{"docs":{"redis_core/persistence/aof.html":{"ref":"redis_core/persistence/aof.html","tf":0.02127659574468085}}}}}}}}}}}}}}}}}}}}}}}},"可":{"docs":{},"靠":{"docs":{},"性":{"docs":{},"高":{"docs":{},"，":{"docs":{},"数":{"docs":{},"据":{"docs":{},"基":{"docs":{},"本":{"docs":{},"不":{"docs":{},"丢":{"docs":{},"失":{"docs":{"redis_core/persistence/aof.html":{"ref":"redis_core/persistence/aof.html","tf":0.02127659574468085}}}}}}}}}}}}}},"同":{"docs":{},"步":{"docs":{},"写":{"docs":{},"回":{"docs":{"redis_core/persistence/aof.html":{"ref":"redis_core/persistence/aof.html","tf":0.02127659574468085}}}}}},"命":{"docs":{},"令":{"docs":{},"执":{"docs":{},"行":{"docs":{},"后":{"docs":{},"才":{"docs":{},"记":{"docs":{},"录":{"docs":{},"日":{"docs":{},"志":{"docs":{},"，":{"docs":{},"不":{"docs":{},"会":{"docs":{},"阻":{"docs":{},"塞":{"docs":{},"当":{"docs":{},"前":{"docs":{},"操":{"docs":{},"作":{"docs":{"redis_core/persistence/aof.html":{"ref":"redis_core/persistence/aof.html","tf":0.02127659574468085}}}}}}}}}}}}}}}}}}}}},"如":{"docs":{},"下":{"docs":{},"所":{"docs":{},"示":{"docs":{},"，":{"docs":{},"*":{"3":{"docs":{},"表":{"docs":{},"示":{"docs":{},"当":{"docs":{},"前":{"docs":{},"命":{"docs":{},"令":{"docs":{},"有":{"3":{"docs":{},"个":{"docs":{},"部":{"docs":{},"分":{"docs":{},"，":{"docs":{},"每":{"docs":{},"部":{"docs":{},"分":{"docs":{},"由":{"docs":{},"“":{"docs":{},"$":{"docs":{},"+":{"docs":{},"数":{"docs":{},"字":{"docs":{},"”":{"docs":{},"开":{"docs":{},"头":{"docs":{},"，":{"docs":{},"后":{"docs":{},"面":{"docs":{},"紧":{"docs":{},"跟":{"docs":{},"命":{"docs":{},"令":{"docs":{},"，":{"docs":{},"这":{"docs":{},"里":{"docs":{},"“":{"docs":{},"数":{"docs":{},"字":{"docs":{},"“":{"docs":{},"表":{"docs":{},"示":{"docs":{},"该":{"docs":{},"部":{"docs":{},"分":{"docs":{},"中":{"docs":{},"命":{"docs":{},"令":{"docs":{"redis_core/persistence/aof.html":{"ref":"redis_core/persistence/aof.html","tf":0.02127659574468085}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}},"docs":{}}}}}}}}},"docs":{}}}}}},"果":{"docs":{},"使":{"docs":{},"用":{"docs":{},"增":{"docs":{},"量":{"docs":{},"快":{"docs":{},"照":{"docs":{},"：":{"docs":{},"做":{"docs":{},"了":{"docs":{},"一":{"docs":{},"次":{"docs":{},"全":{"docs":{},"量":{"docs":{},"快":{"docs":{},"照":{"docs":{},"后":{"docs":{},"，":{"docs":{},"后":{"docs":{},"续":{"docs":{},"的":{"docs":{},"快":{"docs":{},"照":{"docs":{},"只":{"docs":{},"对":{"docs":{},"修":{"docs":{},"改":{"docs":{},"的":{"docs":{},"数":{"docs":{},"据":{"docs":{},"进":{"docs":{},"行":{"docs":{},"快":{"docs":{},"照":{"docs":{},"记":{"docs":{},"录":{"docs":{},"，":{"docs":{},"减":{"docs":{},"少":{"docs":{},"开":{"docs":{},"销":{"docs":{},"。":{"docs":{"redis_core/persistence/rdb.html":{"ref":"redis_core/persistence/rdb.html","tf":0.05}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}},"宕":{"docs":{},"机":{"docs":{},"时":{"docs":{},"丢":{"docs":{},"失":{"1":{"docs":{},"秒":{"docs":{},"数":{"docs":{},"据":{"docs":{"redis_core/persistence/aof.html":{"ref":"redis_core/persistence/aof.html","tf":0.02127659574468085}}}}}},"docs":{},"数":{"docs":{},"据":{"docs":{},"较":{"docs":{},"多":{"docs":{"redis_core/persistence/aof.html":{"ref":"redis_core/persistence/aof.html","tf":0.02127659574468085}}}}}}}}},"后":{"docs":{},"的":{"docs":{},"快":{"docs":{},"速":{"docs":{},"恢":{"docs":{},"复":{"docs":{"redis_core/persistence/rdb.html":{"ref":"redis_core/persistence/rdb.html","tf":0.05}}}}}}}}}},"当":{"docs":{},"r":{"docs":{},"e":{"docs":{},"d":{"docs":{},"i":{"docs":{},"s":{"docs":{},"刚":{"docs":{},"执":{"docs":{},"行":{"docs":{},"完":{"docs":{},"一":{"docs":{},"个":{"docs":{},"命":{"docs":{},"令":{"docs":{},"，":{"docs":{},"还":{"docs":{},"来":{"docs":{},"不":{"docs":{},"及":{"docs":{},"记":{"docs":{},"录":{"docs":{},"日":{"docs":{},"志":{"docs":{},"就":{"docs":{},"宕":{"docs":{},"机":{"docs":{},"了":{"docs":{},"，":{"docs":{},"那":{"docs":{},"该":{"docs":{},"命":{"docs":{},"令":{"docs":{},"和":{"docs":{},"相":{"docs":{},"应":{"docs":{},"的":{"docs":{},"数":{"docs":{},"据":{"docs":{},"有":{"docs":{},"丢":{"docs":{},"失":{"docs":{},"风":{"docs":{},"险":{"docs":{"redis_core/persistence/aof.html":{"ref":"redis_core/persistence/aof.html","tf":0.02127659574468085}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}},"宕":{"docs":{},"机":{"docs":{},"时":{"docs":{},"，":{"docs":{},"可":{"docs":{},"以":{"docs":{},"采":{"docs":{},"用":{"docs":{},"a":{"docs":{},"o":{"docs":{},"f":{"docs":{},"进":{"docs":{},"行":{"docs":{},"恢":{"docs":{},"复":{"docs":{},"，":{"docs":{},"但":{"docs":{},"是":{"docs":{},"如":{"docs":{},"果":{"docs":{},"a":{"docs":{},"o":{"docs":{},"f":{"docs":{},"中":{"docs":{},"操":{"docs":{},"作":{"docs":{},"日":{"docs":{},"志":{"docs":{},"太":{"docs":{},"多":{"docs":{},"，":{"docs":{},"r":{"docs":{},"e":{"docs":{},"d":{"docs":{},"i":{"docs":{},"s":{"docs":{},"就":{"docs":{},"会":{"docs":{},"回":{"docs":{},"复":{"docs":{},"的":{"docs":{},"慢":{"docs":{},"，":{"docs":{},"影":{"docs":{},"响":{"docs":{},"正":{"docs":{},"常":{"docs":{},"使":{"docs":{},"用":{"docs":{},"。":{"docs":{},"因":{"docs":{},"此":{"docs":{},"引":{"docs":{},"入":{"docs":{},"r":{"docs":{},"d":{"docs":{},"b":{"docs":{},"快":{"docs":{},"照":{"docs":{},"（":{"docs":{},"全":{"docs":{},"量":{"docs":{},"快":{"docs":{},"照":{"docs":{},"）":{"docs":{},"，":{"docs":{},"将":{"docs":{},"r":{"docs":{},"e":{"docs":{},"d":{"docs":{},"i":{"docs":{},"s":{"docs":{},"某":{"docs":{},"一":{"docs":{},"时":{"docs":{},"刻":{"docs":{},"的":{"docs":{},"状":{"docs":{},"态":{"docs":{},"以":{"docs":{},"文":{"docs":{},"件":{"docs":{},"的":{"docs":{},"形":{"docs":{},"式":{"docs":{},"写":{"docs":{},"到":{"docs":{},"磁":{"docs":{},"盘":{"docs":{},"上":{"docs":{},"。":{"docs":{"redis_core/persistence/rdb.html":{"ref":"redis_core/persistence/rdb.html","tf":0.05}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}},"性":{"docs":{},"能":{"docs":{},"好":{"docs":{"redis_core/persistence/aof.html":{"ref":"redis_core/persistence/aof.html","tf":0.02127659574468085}}},"适":{"docs":{},"中":{"docs":{"redis_core/persistence/aof.html":{"ref":"redis_core/persistence/aof.html","tf":0.02127659574468085}}}}}},"操":{"docs":{},"作":{"docs":{},"系":{"docs":{},"统":{"docs":{},"控":{"docs":{},"制":{"docs":{},"写":{"docs":{},"回":{"docs":{"redis_core/persistence/aof.html":{"ref":"redis_core/persistence/aof.html","tf":0.02127659574468085}}}}}}}}}},"新":{"docs":{},"的":{"docs":{},"a":{"docs":{},"o":{"docs":{},"f":{"docs":{},"重":{"docs":{},"写":{"docs":{},"日":{"docs":{},"志":{"docs":{},"，":{"docs":{},"新":{"docs":{},"的":{"docs":{},"写":{"docs":{},"操":{"docs":{},"作":{"docs":{},"也":{"docs":{},"会":{"docs":{},"被":{"docs":{},"写":{"docs":{},"到":{"docs":{},"重":{"docs":{},"写":{"docs":{},"日":{"docs":{},"志":{"docs":{},"缓":{"docs":{},"冲":{"docs":{},"区":{"docs":{},"中":{"docs":{},"，":{"docs":{},"重":{"docs":{},"写":{"docs":{},"完":{"docs":{},"成":{"docs":{},"后":{"docs":{},"，":{"docs":{},"将":{"docs":{},"重":{"docs":{},"写":{"docs":{},"缓":{"docs":{},"冲":{"docs":{},"区":{"docs":{},"的":{"docs":{},"最":{"docs":{},"新":{"docs":{},"操":{"docs":{},"作":{"docs":{},"写":{"docs":{},"入":{"docs":{},"新":{"docs":{},"的":{"docs":{},"a":{"docs":{},"o":{"docs":{},"f":{"docs":{},"文":{"docs":{},"件":{"docs":{},"，":{"docs":{},"此":{"docs":{},"时":{"docs":{},"，":{"docs":{},"新":{"docs":{},"的":{"docs":{},"a":{"docs":{},"o":{"docs":{},"f":{"docs":{},"文":{"docs":{},"件":{"docs":{},"就":{"docs":{},"可":{"docs":{},"以":{"docs":{},"将":{"docs":{},"旧":{"docs":{},"的":{"docs":{},"a":{"docs":{},"o":{"docs":{},"f":{"docs":{},"文":{"docs":{},"件":{"docs":{},"替":{"docs":{},"换":{"docs":{},"掉":{"docs":{},"了":{"docs":{"redis_core/persistence/aof.html":{"ref":"redis_core/persistence/aof.html","tf":0.02127659574468085}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}},"日":{"docs":{},"志":{"docs":{},"文":{"docs":{},"件":{"docs":{},"太":{"docs":{},"大":{"docs":{},"了":{"docs":{},"怎":{"docs":{},"么":{"docs":{},"办":{"docs":{},"？":{"docs":{},"—":{"docs":{},"—":{"docs":{},"a":{"docs":{},"o":{"docs":{},"f":{"docs":{},"重":{"docs":{},"写":{"docs":{},"机":{"docs":{},"制":{"docs":{"redis_core/persistence/aof.html":{"ref":"redis_core/persistence/aof.html","tf":0.02127659574468085}}}}}}}}}}}}}}}}}}}}}},"正":{"docs":{},"在":{"docs":{},"使":{"docs":{},"用":{"docs":{},"的":{"docs":{},"a":{"docs":{},"o":{"docs":{},"f":{"docs":{},"日":{"docs":{},"志":{"docs":{},"，":{"docs":{},"r":{"docs":{},"e":{"docs":{},"d":{"docs":{},"i":{"docs":{},"s":{"docs":{},"会":{"docs":{},"将":{"docs":{},"新":{"docs":{},"的":{"docs":{},"写":{"docs":{},"操":{"docs":{},"作":{"docs":{},"日":{"docs":{},"志":{"docs":{},"写":{"docs":{},"入":{"docs":{},"其":{"docs":{},"缓":{"docs":{},"冲":{"docs":{},"区":{"docs":{},"，":{"docs":{},"防":{"docs":{},"止":{"docs":{},"重":{"docs":{},"写":{"docs":{},"期":{"docs":{},"间":{"docs":{},"宕":{"docs":{},"机":{"docs":{},"丢":{"docs":{},"日":{"docs":{},"志":{"docs":{"redis_core/persistence/aof.html":{"ref":"redis_core/persistence/aof.html","tf":0.02127659574468085}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}},"此":{"docs":{},"方":{"docs":{},"式":{"docs":{},"有":{"docs":{},"几":{"docs":{},"个":{"docs":{},"优":{"docs":{},"点":{"docs":{},"：":{"docs":{"redis_core/persistence/aof.html":{"ref":"redis_core/persistence/aof.html","tf":0.02127659574468085}}}}}}}}}}},"每":{"docs":{},"个":{"docs":{},"写":{"docs":{},"命":{"docs":{},"令":{"docs":{},"都":{"docs":{},"要":{"docs":{},"落":{"docs":{},"盘":{"docs":{},"，":{"docs":{},"性":{"docs":{},"能":{"docs":{},"影":{"docs":{},"响":{"docs":{},"较":{"docs":{},"大":{"docs":{"redis_core/persistence/aof.html":{"ref":"redis_core/persistence/aof.html","tf":0.02127659574468085}}}}}}}}}}}}}}}}},"秒":{"docs":{},"写":{"docs":{},"回":{"docs":{"redis_core/persistence/aof.html":{"ref":"redis_core/persistence/aof.html","tf":0.02127659574468085}}}}}},"潜":{"docs":{},"在":{"docs":{},"风":{"docs":{},"险":{"docs":{},"：":{"docs":{"redis_core/persistence/aof.html":{"ref":"redis_core/persistence/aof.html","tf":0.02127659574468085}}}}}}},"缺":{"docs":{},"点":{"docs":{"redis_core/persistence/aof.html":{"ref":"redis_core/persistence/aof.html","tf":0.02127659574468085}}}},"配":{"docs":{},"置":{"docs":{},"项":{"docs":{"redis_core/persistence/aof.html":{"ref":"redis_core/persistence/aof.html","tf":0.02127659574468085}}}}},"重":{"docs":{},"写":{"docs":{},"可":{"docs":{},"以":{"docs":{},"概":{"docs":{},"括":{"docs":{},"为":{"docs":{"redis_core/persistence/aof.html":{"ref":"redis_core/persistence/aof.html","tf":0.02127659574468085}}}}}}}}},"键":{"docs":{"redis_core/persistence/aof.html":{"ref":"redis_core/persistence/aof.html","tf":0.02127659574468085}}},"b":{"docs":{},"g":{"docs":{},"s":{"docs":{},"a":{"docs":{},"v":{"docs":{},"e":{"docs":{},"（":{"docs":{},"默":{"docs":{},"认":{"docs":{},"配":{"docs":{},"置":{"docs":{},"）":{"docs":{},"：":{"docs":{},"创":{"docs":{},"建":{"docs":{},"子":{"docs":{},"进":{"docs":{},"程":{"docs":{},"，":{"docs":{},"专":{"docs":{},"门":{"docs":{},"用":{"docs":{},"于":{"docs":{},"写":{"docs":{},"入":{"docs":{},"r":{"docs":{},"d":{"docs":{},"b":{"docs":{},"，":{"docs":{},"避":{"docs":{},"免":{"docs":{},"了":{"docs":{},"主":{"docs":{},"线":{"docs":{},"程":{"docs":{},"的":{"docs":{},"阻":{"docs":{},"塞":{"docs":{},"。":{"docs":{"redis_core/persistence/rdb.html":{"ref":"redis_core/persistence/rdb.html","tf":0.05}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}},"s":{"docs":{},"a":{"docs":{},"v":{"docs":{},"e":{"docs":{},"：":{"docs":{},"在":{"docs":{},"主":{"docs":{},"线":{"docs":{},"程":{"docs":{},"中":{"docs":{},"执":{"docs":{},"行":{"docs":{},"，":{"docs":{},"会":{"docs":{},"导":{"docs":{},"致":{"docs":{},"阻":{"docs":{},"塞":{"docs":{"redis_core/persistence/rdb.html":{"ref":"redis_core/persistence/rdb.html","tf":0.05}}}}}}}}}}}}}}}}}}}},"但":{"docs":{},"是":{"docs":{},"得":{"docs":{},"记":{"docs":{},"住":{"docs":{},"哪":{"docs":{},"些":{"docs":{},"数":{"docs":{},"据":{"docs":{},"被":{"docs":{},"修":{"docs":{},"改":{"docs":{},"了":{"docs":{},"，":{"docs":{},"需":{"docs":{},"要":{"docs":{},"额":{"docs":{},"外":{"docs":{},"的":{"docs":{},"元":{"docs":{},"信":{"docs":{},"息":{"docs":{},"，":{"docs":{},"空":{"docs":{},"间":{"docs":{},"开":{"docs":{},"销":{"docs":{},"过":{"docs":{},"大":{"docs":{},"，":{"docs":{},"可":{"docs":{},"能":{"docs":{},"得":{"docs":{},"不":{"docs":{},"偿":{"docs":{},"失":{"docs":{},"。":{"docs":{"redis_core/persistence/rdb.html":{"ref":"redis_core/persistence/rdb.html","tf":0.05}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}},"允":{"docs":{},"许":{"docs":{},"分":{"docs":{},"钟":{"docs":{},"级":{"docs":{},"别":{"docs":{},"的":{"docs":{},"数":{"docs":{},"据":{"docs":{},"丢":{"docs":{},"失":{"docs":{},"时":{"docs":{},"，":{"docs":{},"可":{"docs":{},"以":{"docs":{},"只":{"docs":{},"用":{"docs":{},"r":{"docs":{},"d":{"docs":{},"b":{"docs":{},"。":{"docs":{"redis_core/persistence/rdb.html":{"ref":"redis_core/persistence/rdb.html","tf":0.05}}}}}}}}}}}}}}}}}}}}}}},"在":{"docs":{},"生":{"docs":{},"成":{"docs":{},"r":{"docs":{},"d":{"docs":{},"b":{"docs":{},"的":{"docs":{},"过":{"docs":{},"程":{"docs":{},"中":{"docs":{},"，":{"docs":{},"r":{"docs":{},"e":{"docs":{},"d":{"docs":{},"i":{"docs":{},"s":{"docs":{},"也":{"docs":{},"能":{"docs":{},"接":{"docs":{},"收":{"docs":{},"数":{"docs":{},"据":{"docs":{},"修":{"docs":{},"改":{"docs":{},"操":{"docs":{},"作":{"docs":{},"，":{"docs":{},"同":{"docs":{},"样":{"docs":{},"是":{"docs":{},"写":{"docs":{},"时":{"docs":{},"复":{"docs":{},"制":{"docs":{},"机":{"docs":{},"制":{"docs":{},"。":{"docs":{},"一":{"docs":{},"开":{"docs":{},"始":{"docs":{},"b":{"docs":{},"g":{"docs":{},"s":{"docs":{},"a":{"docs":{},"v":{"docs":{},"e":{"docs":{},"子":{"docs":{},"进":{"docs":{},"程":{"docs":{},"会":{"docs":{},"共":{"docs":{},"享":{"docs":{},"主":{"docs":{},"线":{"docs":{},"程":{"docs":{},"数":{"docs":{},"据":{"docs":{},"，":{"docs":{},"当":{"docs":{},"主":{"docs":{},"线":{"docs":{},"程":{"docs":{},"要":{"docs":{},"修":{"docs":{},"改":{"docs":{},"某":{"docs":{},"块":{"docs":{},"数":{"docs":{},"据":{"docs":{},"，":{"docs":{},"就":{"docs":{},"会":{"docs":{},"先":{"docs":{},"复":{"docs":{},"制":{"docs":{},"该":{"docs":{},"块":{"docs":{},"数":{"docs":{},"据":{"docs":{},"给":{"docs":{},"b":{"docs":{},"g":{"docs":{},"s":{"docs":{},"a":{"docs":{},"v":{"docs":{},"e":{"docs":{},"子":{"docs":{},"进":{"docs":{},"程":{"docs":{},"，":{"docs":{},"b":{"docs":{},"g":{"docs":{},"s":{"docs":{},"a":{"docs":{},"v":{"docs":{},"e":{"docs":{},"会":{"docs":{},"将":{"docs":{},"该":{"docs":{},"块":{"docs":{},"数":{"docs":{},"据":{"docs":{},"副":{"docs":{},"本":{"docs":{},"写":{"docs":{},"入":{"docs":{},"r":{"docs":{},"d":{"docs":{},"b":{"docs":{},"文":{"docs":{},"件":{"docs":{},"。":{"docs":{"redis_core/persistence/rdb.html":{"ref":"redis_core/persistence/rdb.html","tf":0.05}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}},"数":{"docs":{},"据":{"docs":{},"不":{"docs":{},"能":{"docs":{},"丢":{"docs":{},"失":{"docs":{},"时":{"docs":{},"，":{"docs":{},"选":{"docs":{},"用":{"docs":{},"a":{"docs":{},"o":{"docs":{},"f":{"docs":{},"+":{"docs":{},"r":{"docs":{},"d":{"docs":{},"b":{"docs":{},"混":{"docs":{},"和":{"docs":{},"使":{"docs":{},"用":{"docs":{},"。":{"docs":{"redis_core/persistence/rdb.html":{"ref":"redis_core/persistence/rdb.html","tf":0.05}}}}}}}}}}}}}}}}}}}}}}}},"生":{"docs":{},"成":{"docs":{},"r":{"docs":{},"d":{"docs":{},"b":{"docs":{},"快":{"docs":{},"照":{"docs":{},"的":{"docs":{},"频":{"docs":{},"率":{"docs":{},"？":{"docs":{"redis_core/persistence/rdb.html":{"ref":"redis_core/persistence/rdb.html","tf":0.05}}}}}}}},"过":{"docs":{},"程":{"docs":{},"会":{"docs":{},"阻":{"docs":{},"塞":{"docs":{},"主":{"docs":{},"线":{"docs":{},"程":{"docs":{},"吗":{"docs":{"redis_core/persistence/rdb.html":{"ref":"redis_core/persistence/rdb.html","tf":0.05}}}}}}}}}}}}}}}},"磁":{"docs":{},"盘":{"docs":{},"压":{"docs":{},"力":{"docs":{},"大":{"docs":{},"，":{"docs":{},"多":{"docs":{},"个":{"docs":{},"快":{"docs":{},"照":{"docs":{},"抢":{"docs":{},"占":{"docs":{},"磁":{"docs":{},"盘":{"docs":{},"资":{"docs":{},"源":{"docs":{},"带":{"docs":{},"宽":{"docs":{},"，":{"docs":{},"前":{"docs":{},"一":{"docs":{},"个":{"docs":{},"快":{"docs":{},"照":{"docs":{},"还":{"docs":{},"没":{"docs":{},"完":{"docs":{},"成":{"docs":{},"，":{"docs":{},"后":{"docs":{},"一":{"docs":{},"个":{"docs":{},"又":{"docs":{},"开":{"docs":{},"始":{"docs":{},"做":{"docs":{},"了":{"docs":{},"，":{"docs":{},"形":{"docs":{},"成":{"docs":{},"恶":{"docs":{},"性":{"docs":{},"循":{"docs":{},"环":{"docs":{},"。":{"docs":{"redis_core/persistence/rdb.html":{"ref":"redis_core/persistence/rdb.html","tf":0.05}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}},"若":{"docs":{},"只":{"docs":{},"用":{"docs":{},"a":{"docs":{},"o":{"docs":{},"f":{"docs":{},"，":{"docs":{},"优":{"docs":{},"先":{"docs":{},"使":{"docs":{},"用":{"docs":{},"e":{"docs":{},"v":{"docs":{},"e":{"docs":{},"r":{"docs":{},"y":{"docs":{},"s":{"docs":{},"e":{"docs":{},"c":{"docs":{},"配":{"docs":{},"置":{"docs":{},"项":{"docs":{},"，":{"docs":{},"因":{"docs":{},"为":{"docs":{},"他":{"docs":{},"在":{"docs":{},"可":{"docs":{},"靠":{"docs":{},"性":{"docs":{},"和":{"docs":{},"性":{"docs":{},"能":{"docs":{},"之":{"docs":{},"间":{"docs":{},"取":{"docs":{},"了":{"docs":{},"一":{"docs":{},"个":{"docs":{},"平":{"docs":{},"衡":{"docs":{},"。":{"docs":{"redis_core/persistence/rdb.html":{"ref":"redis_core/persistence/rdb.html","tf":0.05}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}},"频":{"docs":{},"繁":{"docs":{},"的":{"docs":{},"进":{"docs":{},"行":{"docs":{},"全":{"docs":{},"量":{"docs":{},"快":{"docs":{},"照":{"docs":{},"，":{"docs":{},"有":{"docs":{},"两":{"docs":{},"方":{"docs":{},"面":{"docs":{},"的":{"docs":{},"开":{"docs":{},"销":{"docs":{},":":{"docs":{"redis_core/persistence/rdb.html":{"ref":"redis_core/persistence/rdb.html","tf":0.05}}}}}}}}}}}}}}}}}}}}},"length":76},"corpusTokens":["alway","aof","aof与rdb混合使用","aof和rdb如何选择","aof日志","aof日志的内容","aof是以追加的方式，逐一记录收到的命令，当一个键值对被多条写命令反复修改时，aof文件会记录相应的多条命令，导致文件越来越大。","aof虽然避免了对当前命令的阻塞，但可能会阻塞下个命令。因为aof日志（落盘）也是在主线程执行的","aof重写会阻塞主线程吗？","aof重写机制就是，redis根据数据库现状创建一个新的aof文件，读取库中所有键值对，对每一个键值对用一条命令记录它的写入。起到了”多变一“的效果。","aof重写的潜在风险","bgsave（默认配置）：创建子进程，专门用于写入rdb，避免了主线程的阻塞。","everysec","fork子进程的瞬间，会阻塞主进程；fork时不会一次性copy所有内存数据给子进程，而是使用os提供的写时复制（copi","fork子进程的过程本身会阻塞主线程。频繁的fork，就会频繁的阻塞。","log的wal（写前日志）不同，aof机制是先执行命令，将数据写入内存，再记录日志。","rdb","rdb快照","rdb快照按一定频率进行，在两次快照之间，使用aof日志记录这期间所有命令，第二次做全量快照时，就可以清空aof日志。aof文件不会过大了，也可以避免重写。","redis提供了如下两个命令来生成rdb文件:","redis核心技术","save：在主线程中执行，会导致阻塞","write）机制，避免一次性copy大量数据而阻塞。","”一个拷贝，两处日志“","一个拷贝是指：重写时主线程fork出后台的bgrewriteaof子进程，此时，fork会把主线程的内存拷贝一份给bgrewriteaof，其中包含了数据库中的最新数据，就能进行aof重写了","一些学习笔记与技术总结","不会，因为重写过程是后台线程bgrewriteaof完成的。","与mysql的redo","两处日志是指：","主从数据同步","主从集群","主要风险有2点：","优点","但是得记住哪些数据被修改了，需要额外的元信息，空间开销过大，可能得不偿失。","保证aof日志中的命令是正确的（命令报错直接返回，避免记录错误的命令）","值有多少字节。当redis重启需要恢复数据时，就会读取aof文件中的命令，逐一执行。","允许分钟级别的数据丢失时，可以只用rdb。","内容示例：*3$3set$7testkey$9testvalu","写后日志","写后日志的风险均来自于aof写入磁盘的时机，redis提供了如下3种写回策略，可通过appendfsync配置项设置：","写回时机","写时拷贝发生时，拷贝bigkey可能会阻塞。","可靠性高，数据基本不丢失","同步写回","命令执行后才记录日志，不会阻塞当前操作","在生成rdb的过程中，redis也能接收数据修改操作，同样是写时复制机制。一开始bgsave子进程会共享主线程数据，当主线程要修改某块数据，就会先复制该块数据给bgsave子进程，bgsave会将该块数据副本写入rdb文件。","如下所示，*3表示当前命令有3个部分，每部分由“$+数字”开头，后面紧跟命令，这里“数字“表示该部分中命令","如果使用增量快照：做了一次全量快照后，后续的快照只对修改的数据进行快照记录，减少开销。","宕机后的快速恢复","宕机时丢失1秒数据","宕机时丢失数据较多","当redis刚执行完一个命令，还来不及记录日志就宕机了，那该命令和相应的数据有丢失风险","当redis宕机时，可以采用aof进行恢复，但是如果aof中操作日志太多，redis就会回复的慢，影响正常使用。因此引入rdb快照（全量快照），将redis某一时刻的状态以文件的形式写到磁盘上。","性能好","性能适中","持久化机制","操作系统控制写回","数据不能丢失时，选用aof+rdb混和使用。","新的aof重写日志，新的写操作也会被写到重写日志缓冲区中，重写完成后，将重写缓冲区的最新操作写入新的aof文件，此时，新的aof文件就可以将旧的aof文件替换掉了","日志文件太大了怎么办？——aof重写机制","正在使用的aof日志，redis会将新的写操作日志写入其缓冲区，防止重写期间宕机丢日志","此方式有几个优点：","每个写命令都要落盘，性能影响较大","每秒写回","潜在风险：","生成rdb快照的频率？","生成rdb过程会阻塞主线程吗","磁盘压力大，多个快照抢占磁盘资源带宽，前一个快照还没完成，后一个又开始做了，形成恶性循环。","简介","缺点","若只用aof，优先使用everysec配置项，因为他在可靠性和性能之间取了一个平衡。","通过aof日志和rdb快照的方式，使redis是可靠的。","配置项","重写可以概括为","键","频繁的进行全量快照，有两方面的开销:"],"pipeline":["stopWordFilter","stemmer"]},"store":{"./":{"url":"./","title":"简介","keywords":"","body":"简介\n一些学习笔记与技术总结\n"},"redis_core/":{"url":"redis_core/","title":"redis核心技术","keywords":"","body":"redis核心技术\n"},"redis_core/persistence/":{"url":"redis_core/persistence/","title":"持久化机制","keywords":"","body":"持久化机制\n通过AOF日志和RDB快照的方式，使redis是可靠的。\n"},"redis_core/persistence/aof.html":{"url":"redis_core/persistence/aof.html","title":"AOF","keywords":"","body":"AOF日志\nAOF日志的内容\n如下所示，*3表示当前命令有3个部分，每部分由“$+数字”开头，后面紧跟命令，这里“数字“表示该部分中命令 or 键 or 值有多少字节。当redis重启需要恢复数据时，就会读取AOF文件中的命令，逐一执行。\n\n内容示例：*3$3set$7testkey$9testvalue\n\n写后日志\n与mysql的redo log的WAL（写前日志）不同，AOF机制是先执行命令，将数据写入内存，再记录日志。\n此方式有几个优点：\n\n保证AOF日志中的命令是正确的（命令报错直接返回，避免记录错误的命令）\n命令执行后才记录日志，不会阻塞当前操作\n\n潜在风险：\n\n当redis刚执行完一个命令，还来不及记录日志就宕机了，那该命令和相应的数据有丢失风险\nAOF虽然避免了对当前命令的阻塞，但可能会阻塞下个命令。因为AOF日志（落盘）也是在主线程执行的\n\n写后日志的风险均来自于AOF写入磁盘的时机，redis提供了如下3种写回策略，可通过appendfsync配置项设置：\n\n\n\n配置项\n写回时机\n优点\n缺点\n\n\n\n\nAlways\n同步写回\n可靠性高，数据基本不丢失\n每个写命令都要落盘，性能影响较大\n\n\nEverysec\n每秒写回\n性能适中\n宕机时丢失1秒数据\n\n\nNo\n操作系统控制写回\n性能好\n宕机时丢失数据较多\n\n\n\n日志文件太大了怎么办？——AOF重写机制\nAOF是以追加的方式，逐一记录收到的命令，当一个键值对被多条写命令反复修改时，AOF文件会记录相应的多条命令，导致文件越来越大。\nAOF重写机制就是，redis根据数据库现状创建一个新的AOF文件，读取库中所有键值对，对每一个键值对用一条命令记录它的写入。起到了”多变一“的效果。\nAOF重写会阻塞主线程吗？\n不会，因为重写过程是后台线程bgrewriteaof完成的。\n重写可以概括为 ”一个拷贝，两处日志“\n一个拷贝是指：重写时主线程fork出后台的bgrewriteaof子进程，此时，fork会把主线程的内存拷贝一份给bgrewriteaof，其中包含了数据库中的最新数据，就能进行AOF重写了\n两处日志是指：\n\n正在使用的AOF日志，redis会将新的写操作日志写入其缓冲区，防止重写期间宕机丢日志\n新的AOF重写日志，新的写操作也会被写到重写日志缓冲区中，重写完成后，将重写缓冲区的最新操作写入新的AOF文件，此时，新的AOF文件就可以将旧的AOF文件替换掉了\n\nAOF重写的潜在风险\n主要风险有2点：\n\nfork子进程的瞬间，会阻塞主进程；fork时不会一次性copy所有内存数据给子进程，而是使用OS提供的写时复制（Copy On Write）机制，避免一次性copy大量数据而阻塞。\n写时拷贝发生时，拷贝bigkey可能会阻塞。\n\n"},"redis_core/persistence/rdb.html":{"url":"redis_core/persistence/rdb.html","title":"RDB","keywords":"","body":"RDB快照\n\n宕机后的快速恢复\n\n当redis宕机时，可以采用AOF进行恢复，但是如果AOF中操作日志太多，redis就会回复的慢，影响正常使用。因此引入RDB快照（全量快照），将redis某一时刻的状态以文件的形式写到磁盘上。\n生成RDB过程会阻塞主线程吗\nredis提供了如下两个命令来生成RDB文件:\n\nsave：在主线程中执行，会导致阻塞\nbgsave（默认配置）：创建子进程，专门用于写入RDB，避免了主线程的阻塞。\n\n在生成RDB的过程中，redis也能接收数据修改操作，同样是写时复制机制。一开始bgsave子进程会共享主线程数据，当主线程要修改某块数据，就会先复制该块数据给bgsave子进程，bgsave会将该块数据副本写入RDB文件。\n生成RDB快照的频率？\n频繁的进行全量快照，有两方面的开销:\n\n磁盘压力大，多个快照抢占磁盘资源带宽，前一个快照还没完成，后一个又开始做了，形成恶性循环。\nfork子进程的过程本身会阻塞主线程。频繁的fork，就会频繁的阻塞。\n\n如果使用增量快照：做了一次全量快照后，后续的快照只对修改的数据进行快照记录，减少开销。\n但是得记住哪些数据被修改了，需要额外的元信息，空间开销过大，可能得不偿失。\nAOF与RDB混合使用\nRDB快照按一定频率进行，在两次快照之间，使用AOF日志记录这期间所有命令，第二次做全量快照时，就可以清空AOF日志。AOF文件不会过大了，也可以避免重写。\nAOF和RDB如何选择\n\n数据不能丢失时，选用AOF+RDB混和使用。\n允许分钟级别的数据丢失时，可以只用RDB。\n若只用AOF，优先使用everysec配置项，因为他在可靠性和性能之间取了一个平衡。\n\n"},"redis_core/master-slave/":{"url":"redis_core/master-slave/","title":"主从集群","keywords":"","body":"主从集群\n"},"redis_core/master-slave/data_sync.html":{"url":"redis_core/master-slave/data_sync.html","title":"主从数据同步","keywords":"","body":"主从数据同步\n"}}}